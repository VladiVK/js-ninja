# TypeScript

## 1-TypeScript-Intro

---

Программы — это файлы, содержащие прописанный вами текст. Специальная программа — компилятор —

считывает и преобразует ваш текст в `абстрактное синтаксическое дерево (АСД)`. Оно представляет собой

структуру данных, игнорирующую пустые области, комментарии и ваше ценное мнение о пробелах или

табуляции. Затем компилятор преобразует `АСД` в низкоуровневую форму — байт-код, который можно

запустить в среде выполнения и получить результат. Итак, когда вы запускаете программу, фактически вы

просите среду выполнения считать байт-код, сгенерированный компилятором на основе `АСД`, полученного из

исходного кода. Детали этого процесса могут отличаться, но для большинства языков он выглядит так:

1. Программа преобразуется в АСД.

2. АСД компилируется в байт-код.

3. Байт-код считывается средой выполнения.

Особенность `TypeScript` в том, что вместо компиляции прямо в байт-код он компилирует

в код `JavaScript`. Затем вы просто запускаете его в браузере.

«Причем здесь безопасность кода?».

Отличный вопрос. Пропущен важный этап: после создания `АСД` компилятор проверяет типы.

В проверке типов заключена магия `TypeScript`. С ее помощью он убеждается, что

программа работает так, как вы ожидаете.

Схема всего процесса:

Сначала действует `TypeScript`

```
- Код на `TypeScript` -> `TypeScript АСД`

- АСД проверяется проверкой типов

- `TypeScript АСД` -> код на `JS`

```

Теперь работает только `JS`

```
- Код на JS -> JavaScript АСД

- АСД -> байт-код

- байт-код оценивается по времени выполнения

```

> JavaScript-компиляторы и среды выполнения, как правило, представляют собой единую программу,
>
> называемую движком. Именно поэтому JavaScript и называют интерпретируемым языком.

Стоит еще раз повториться: когда TSC компилирует код в JavaScript, он не будет смотреть на типы.

Это означает, что типы никогда не смогут повлиять на сгенерированный вывод и будут использованы

только для проверки типов.

> СИСТЕМА ТИПОВ - это
>
> Набор правил, используемых модулем проверки типов для присвоения типов программе.

Главным образом системы типов делятся на два вида: в одних вы должны сообщать

компилятору тип каждого элемента посредством явного синтаксиса, другие выводят

типы автоматически.

TypeScript создан на стыке этих двух видов: вы можете явно аннотировать типы либо

позволить TypeScript делать их вывод за вас.

```
let a: number = 1                       // a является number
let b: string = 'hello'                 // b является string
let c: boolean[] = [true, false]        // c является массивом booleans

```

| Система типов                        | JavaScript                       | TypeScript                       |
| ------------------------------------ | -------------------------------- | -------------------------------- |
| Как связываются типы                 | Динамически                      | Статически                       |
| Конвертируются ли типы автоматически | Да                               | Нет (в основном)                 |
| Когда проверяются типы               | Во время выполнения              | Во время компиляции              |
| Когда вскрываются ошибки             | Во время выполнения (в основном) | Во время компиляции (в основном) |

К слову, есть множество возможных ошибок, которые TypeScript не может обнаружить

при компиляции. К ним относятся переполнения стека, разрывы сетевых соединений и

некорректный ввод данных пользователем. Все они по-прежнему будут производить

исключения при выполнении. Что же TypeScript действительно делает хорошо, так это

вычисляет ошибки при компиляции, которые в противном случае стали бы ошибками при

выполнении в среде чистого JavaScript.

## 1.1-TypeScript-Install TypeScript

---

Начнем с первой ручной установки.

- Создание каталога

`mkdir demo`

`cd demo`

- Инициализация нового проекта NPM (следуйте инструкциям)

`npm init`

- Установка TSC, TSLint и деклараций типов для NodeJS

`npm install --save-dev typescript tslint @types/node`

### - Файл `tsconfig.json`

Каждый TypeScript-проект должен содержать в корневой директории файл `tsconfig.json.`

- Создайте файл с именем tsconfig.json

```
{
  "compilerOptions": {
    "lib": ["es2015"],
    "module": "commonjs",
    "outDir": "dist",
    "sourceMap": true,
    "strict": true,
    "target": "es2015"
  },
  "include": ["src"]
}
```

`Таблица Опции tsconfig.json`

| Опция     | Описание                                                                                                                                                                                        |
| --------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `include` | В каких каталогах TSC должен искать файлы TypeScript?                                                                                                                                           |
| `lib`     | Наличие каких API в вашей среде разработки должен предполагать TSC? Это касается также таких элементов, как Function.prototype.bind в ES5, Object.assign в ES2015 и document DOM.querySelector? |
| `module`  | В какую модульную систему должен производить компиляцию TSC (CommonJS, SystemJS, ES2015 и пр.)?                                                                                                 |
| `outDir`  | В какой каталог TSC должен помещать сгенерированный JavaScript-код?                                                                                                                             |
| `strict`  | Как производить максимально строгую проверку кода и соблюдать правильную типизацию? Мы будем использовать ее во всех примерах. Активируйте ее в своем проекте                                   |
| `target`  | В какую версию JavaScript нужно компилировать код (ES3, ES5, ES2015, ES2016 и пр.)?                                                                                                             |

Это лишь несколько из десятков опций, которые поддерживает tsconfig.json, причем постоянно

добавляются новые.

Вы также можете установить бˆольшую часть опций TSC через командную строку:

запустите `./node_modules/.bin/tsc --help` для вывода их списка.

### - Файл `tslint.json` (необязательно)

В вашем проекте также должен присутствовать файл `tslint.json`, содержащий конфигурацию `TSLint`,

определяющую необходимую вам стилистику кода (табуляции, пробелы и пр.).

Следующая команда сгенерирует файл `tslint.json` со стандартной конфигурацией `TSLint`:

```
./node_modules/.bin/tslint --init
```

Далее вы можете переписать ее согласно своему стилю. Например, мой файл tslint.json выглядит так:

```
{
"defaultSeverity": "error",
"extends": [
"tslint:recommended"
],
"rules": {
"semicolon": false,
"trailing-comma": false
}
}
```

Полный список доступных правил содержится в документации TSLint. Вы также можете

добавлять пользовательские правила или устанавливать дополнительные настройки

(как для ReactJS: `https://www.npmjs.com/package/tslint-react`).

### - `Файл index.ts`

```
создать src
создать src/index.ts
```

Переходим в этот файл и что-то пишем.

Затем скомпилируйте и запустите TypeScript-код:

- Скомпилируйте код с помощью TSC

```
./node_modules/.bin/tsc
```

- Запустите код с помощью NodeJS

```
node ./dist/index.js
```

Более удобный вариант использовать готовые пакеты:

Локально

```
# Locally in your project.
npm install -D typescript
npm install -D ts-node

# Or globally with TypeScript.
npm install -g typescript
npm install -g ts-node

```

То есть:

```
npm install -g typescript ts-node

```

Теперь просто указываем:

```
tsc index.ts
```
